databaseChangeLog:
  # Create users_organizations_association
  - changeSet:
      id: 2025-09-07-1
      author: belkanaphan
      context: prod
      onFail: MARK_RAN
      changes:
        - sql:
            sql: |
              CREATE TABLE IF NOT EXISTS users_organizations_association (
                organization_id BIGINT NOT NULL,
                user_id BIGINT NOT NULL,
                PRIMARY KEY (organization_id, user_id),
                FOREIGN KEY (organization_id) REFERENCES organization(id) ON DELETE CASCADE,
                FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
              );
      rollback:
        - sql:
            sql: |
              DROP TABLE IF EXISTS users_organizations_association;
  # Create rounds_participants_association
  - changeSet:
      id: 2025-09-07-2
      author: belkanaphan
      context: prod
      onFail: MARK_RAN
      changes:
        - sql:
            sql: |
              CREATE TABLE IF NOT EXISTS rounds_participants_association (
                participant_id BIGINT NOT NULL,
                round_id BIGINT NOT NULL,
                PRIMARY KEY (participant_id, round_id),
                FOREIGN KEY (participant_id) REFERENCES participant(id) ON DELETE CASCADE,
                FOREIGN KEY (round_id) REFERENCES round(id) ON DELETE CASCADE
              );
      rollback:
        - sql:
            sql: |
              DROP TABLE IF EXISTS rounds_participants_association;
  # Create milestones_participants_association
  - changeSet:
      id: 2025-09-07-3
      author: belkanaphan
      context: prod
      onFail: MARK_RAN
      changes:
        - sql:
            sql: |
              CREATE TABLE IF NOT EXISTS milestones_participants_association (
                participant_id BIGINT NOT NULL,
                milestone_id BIGINT NOT NULL,
                PRIMARY KEY (participant_id, milestone_id),
                FOREIGN KEY (participant_id) REFERENCES participant(id) ON DELETE CASCADE,
                FOREIGN KEY (milestone_id) REFERENCES milestone(id) ON DELETE CASCADE
              );
      rollback:
        - sql:
            sql: |
              DROP TABLE IF EXISTS milestones_participants_association;